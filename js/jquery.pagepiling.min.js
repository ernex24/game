!function($,document,window,undefined){"use strict";$.fn.pagepiling=function(custom){var PP=$.fn.pagepiling,container=$(this),lastScrolledDestiny,lastAnimation=0,isTouch="ontouchstart"in window||navigator.msMaxTouchPoints>0||navigator.maxTouchPoints,touchStartY=0,touchStartX=0,touchEndY=0,touchEndX=0,scrollings=[],scrollDelay=600,options=$.extend(!0,{direction:"vertical",menu:null,verticalCentered:!0,sectionsColor:[],anchors:[],scrollingSpeed:700,easing:"easeInQuart",loopBottom:!1,loopTop:!1,css3:!0,navigation:{textColor:"#000",bulletsColor:"#000",position:"right",tooltips:[]},normalScrollElements:null,normalScrollElementTouchThreshold:5,touchSensitivity:5,keyboardScrolling:!0,sectionSelector:".section",animateAnchor:!1,afterLoad:null,onLeave:null,afterRender:null},custom);$.extend($.easing,{easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b}}),PP.setScrollingSpeed=function(value){options.scrollingSpeed=value},PP.setMouseWheelScrolling=function(value){value?addMouseWheelHandler():removeMouseWheelHandler()},PP.setAllowScrolling=function(value){value?(PP.setMouseWheelScrolling(!0),addTouchHandler()):(PP.setMouseWheelScrolling(!1),removeTouchHandler())},PP.setKeyboardScrolling=function(value){options.keyboardScrolling=value},PP.moveSectionUp=function(){var prev=$(".pp-section.active").prev(".pp-section");!prev.length&&options.loopTop&&(prev=$(".pp-section").last()),prev.length&&scrollPage(prev)},PP.moveSectionDown=function(){var next=$(".pp-section.active").next(".pp-section");!next.length&&options.loopBottom&&(next=$(".pp-section").first()),next.length&&scrollPage(next)},PP.moveTo=function(section){var destiny="";(destiny=isNaN(section)?$(document).find('[data-anchor="'+section+'"]'):$(".pp-section").eq(section-1)).length>0&&scrollPage(destiny)},$(options.sectionSelector).each(function(){$(this).addClass("pp-section")}),options.css3&&(options.css3=support3d()),$(container).css({overflow:"hidden","-ms-touch-action":"none","touch-action":"none"}),PP.setAllowScrolling(!0),$.isEmptyObject(options.navigation)||addVerticalNavigation();var zIndex=$(".pp-section").length;function addTableClass(element){element.addClass("pp-table").wrapInner('<div class="pp-tableCell" style="height:100%" />')}function getYmovement(destiny){var fromIndex,toIndex;return $(".pp-section.active").index(".pp-section")>destiny.index(".pp-section")?"up":"down"}function scrollPage(destination,animated){var v={destination:destination,animated:animated,activeSection:$(".pp-section.active"),anchorLink:destination.data("anchor"),sectionIndex:destination.index(".pp-section"),toMove:destination,yMovement:getYmovement(destination),leavingSection:$(".pp-section.active").index(".pp-section")+1};if(!v.activeSection.is(destination)){void 0===v.animated&&(v.animated=!0),void 0!==v.anchorLink&&setURLHash(v.anchorLink,v.sectionIndex),v.destination.addClass("active").siblings().removeClass("active"),v.sectionsToMove=getSectionsToMove(v),"down"===v.yMovement?(v.translate3d=getTranslate3d(),v.scrolling="-100%",options.css3||v.sectionsToMove.each(function(index){index!=v.activeSection.index(".pp-section")&&$(this).css(getScrollProp(v.scrolling))}),v.animateSection=v.activeSection):(v.translate3d="translate3d(0px, 0px, 0px)",v.scrolling="0",v.animateSection=destination),$.isFunction(options.onLeave)&&options.onLeave.call(this,v.leavingSection,v.sectionIndex+1,v.yMovement),performMovement(v),activateMenuElement(v.anchorLink),activateNavDots(v.anchorLink,v.sectionIndex),lastScrolledDestiny=v.anchorLink;var timeNow=(new Date).getTime();lastAnimation=timeNow}}function performMovement(v){options.css3?(transformContainer(v.animateSection,v.translate3d,v.animated),v.sectionsToMove.each(function(){transformContainer($(this),v.translate3d,v.animated)}),setTimeout(function(){afterSectionLoads(v)},options.scrollingSpeed)):(v.scrollOptions=getScrollProp(v.scrolling),v.animated?v.animateSection.animate(v.scrollOptions,options.scrollingSpeed,options.easing,function(){readjustSections(v),afterSectionLoads(v)}):(v.animateSection.css(getScrollProp(v.scrolling)),setTimeout(function(){readjustSections(v),afterSectionLoads(v)},400)))}function afterSectionLoads(v){$.isFunction(options.afterLoad)&&options.afterLoad.call(this,v.anchorLink,v.sectionIndex+1)}function getSectionsToMove(v){var sectionToMove;return sectionToMove="down"===v.yMovement?$(".pp-section").map(function(index){if(index<v.destination.index(".pp-section"))return $(this)}):$(".pp-section").map(function(index){if(index>v.destination.index(".pp-section"))return $(this)})}function readjustSections(v){"up"===v.yMovement&&v.sectionsToMove.each(function(index){$(this).css(getScrollProp(v.scrolling))})}function getScrollProp(propertyValue){return"vertical"===options.direction?{top:propertyValue}:{left:propertyValue}}function silentScroll(section,offset){options.css3?transformContainer(section,getTranslate3d(),!1):section.css(getScrollProp(offset))}function setURLHash(anchorLink,sectionIndex){options.anchors.length?(location.hash=anchorLink,setBodyClass(location.hash)):setBodyClass(String(sectionIndex))}function setBodyClass(text){text=text.replace("#",""),$("body")[0].className=$("body")[0].className.replace(/\b\s?pp-viewing-[^\s]+\b/g,""),$("body").addClass("pp-viewing-"+text)}function scrollToAnchor(){var value,sectionAnchor=window.location.hash.replace("#",""),section=$(document).find('.pp-section[data-anchor="'+sectionAnchor+'"]');section.length>0&&scrollPage(section,options.animateAnchor)}function isMoving(){var timeNow;return(new Date).getTime()-lastAnimation<scrollDelay+options.scrollingSpeed}function hashChangeHandler(){var value,sectionAnchor=window.location.hash.replace("#","").split("/")[0],section;sectionAnchor.length&&(sectionAnchor&&sectionAnchor!==lastScrolledDestiny&&scrollPage(section=isNaN(sectionAnchor)?$(document).find('[data-anchor="'+sectionAnchor+'"]'):$(".pp-section").eq(sectionAnchor-1)))}function getTransforms(translate3d){return{"-webkit-transform":translate3d,"-moz-transform":translate3d,"-ms-transform":translate3d,transform:translate3d}}function transformContainer(element,translate3d,animated){element.toggleClass("pp-easing",animated),element.css(getTransforms(translate3d))}$(".pp-section").each(function(index){$(this).data("data-index",index),$(this).css("z-index",zIndex),index||0!==$(".pp-section.active").length||$(this).addClass("active"),void 0!==options.anchors[index]&&$(this).attr("data-anchor",options.anchors[index]),void 0!==options.sectionsColor[index]&&$(this).css("background-color",options.sectionsColor[index]),options.verticalCentered&&!$(this).hasClass("pp-scrollable")&&addTableClass($(this)),zIndex-=1}).promise().done(function(){options.navigation&&($("#pp-nav").css("margin-top","-"+$("#pp-nav").height()/2+"px"),$("#pp-nav").find("li").eq($(".pp-section.active").index(".pp-section")).find("a").addClass("active")),$(window).on("load",function(){scrollToAnchor()}),$.isFunction(options.afterRender)&&options.afterRender.call(this)}),$(window).on("hashchange",hashChangeHandler),$(document).keydown(function(e){if(options.keyboardScrolling&&!isMoving())switch(e.which){case 38:case 33:PP.moveSectionUp();break;case 40:case 34:PP.moveSectionDown();break;case 36:PP.moveTo(1);break;case 35:PP.moveTo($(".pp-section").length);break;case 37:PP.moveSectionUp();break;case 39:PP.moveSectionDown();break;default:return}}),options.normalScrollElements&&($(document).on("mouseenter",options.normalScrollElements,function(){PP.setMouseWheelScrolling(!1)}),$(document).on("mouseleave",options.normalScrollElements,function(){PP.setMouseWheelScrolling(!0)}));var prevTime=(new Date).getTime();function MouseWheelHandler(e){var curTime=(new Date).getTime(),value=(e=e||window.event).wheelDelta||-e.deltaY||-e.detail,delta=Math.max(-1,Math.min(1,value)),horizontalDetection=void 0!==e.wheelDeltaX||void 0!==e.deltaX,isScrollingVertically=Math.abs(e.wheelDeltaX)<Math.abs(e.wheelDelta)||Math.abs(e.deltaX)<Math.abs(e.deltaY)||!horizontalDetection;scrollings.length>149&&scrollings.shift(),scrollings.push(Math.abs(value));var timeDiff=curTime-prevTime;if(prevTime=curTime,timeDiff>200&&(scrollings=[]),!isMoving()){var activeSection,scrollable=isScrollable($(".pp-section.active")),averageEnd,averageMiddle,isAccelerating;return getAverage(scrollings,10)>=getAverage(scrollings,70)&&isScrollingVertically&&(delta<0?scrolling("down",scrollable):delta>0&&scrolling("up",scrollable)),!1}}function getAverage(elements,number){for(var sum=0,lastElements=elements.slice(Math.max(elements.length-number,1)),i=0;i<lastElements.length;i++)sum+=lastElements[i];return Math.ceil(sum/number)}function scrolling(type,scrollable){var check,scrollSection;if("down"==type?(check="bottom",scrollSection=PP.moveSectionDown):(check="top",scrollSection=PP.moveSectionUp),scrollable.length>0){if(!isScrolled(check,scrollable))return!0;scrollSection()}else scrollSection()}function isScrolled(type,scrollable){return"top"===type?!scrollable.scrollTop():"bottom"===type?scrollable.scrollTop()+1+scrollable.innerHeight()>=scrollable[0].scrollHeight:void 0}function isScrollable(activeSection){return activeSection.filter(".pp-scrollable")}function removeMouseWheelHandler(){container.get(0).addEventListener?(container.get(0).removeEventListener("mousewheel",MouseWheelHandler,!1),container.get(0).removeEventListener("wheel",MouseWheelHandler,!1)):container.get(0).detachEvent("onmousewheel",MouseWheelHandler)}function addMouseWheelHandler(){container.get(0).addEventListener?(container.get(0).addEventListener("mousewheel",MouseWheelHandler,!1),container.get(0).addEventListener("wheel",MouseWheelHandler,!1)):container.get(0).attachEvent("onmousewheel",MouseWheelHandler)}function addTouchHandler(){if(isTouch){var MSPointer=getMSPointer();container.off("touchstart "+MSPointer.down).on("touchstart "+MSPointer.down,touchStartHandler),container.off("touchmove "+MSPointer.move).on("touchmove "+MSPointer.move,touchMoveHandler)}}function removeTouchHandler(){if(isTouch){var MSPointer=getMSPointer();container.off("touchstart "+MSPointer.down),container.off("touchmove "+MSPointer.move)}}function getMSPointer(){var pointer;return pointer=window.PointerEvent?{down:"pointerdown",move:"pointermove",up:"pointerup"}:{down:"MSPointerDown",move:"MSPointerMove",up:"MSPointerUp"}}function getEventsPage(e){var events=new Array;return events.y=void 0!==e.pageY&&(e.pageY||e.pageX)?e.pageY:e.touches[0].pageY,events.x=void 0!==e.pageX&&(e.pageY||e.pageX)?e.pageX:e.touches[0].pageX,events}function isReallyTouch(e){return void 0===e.pointerType||"mouse"!=e.pointerType}function touchStartHandler(event){var e=event.originalEvent;if(isReallyTouch(e)){var touchEvents=getEventsPage(e);touchStartY=touchEvents.y,touchStartX=touchEvents.x}}function touchMoveHandler(event){var e=event.originalEvent;if(!checkParentForNormalScrollElement(event.target)&&isReallyTouch(e)){var activeSection,scrollable=isScrollable($(".pp-section.active"));if(scrollable.length||event.preventDefault(),!isMoving()){var touchEvents=getEventsPage(e);touchEndY=touchEvents.y,touchEndX=touchEvents.x,"horizontal"===options.direction&&Math.abs(touchStartX-touchEndX)>Math.abs(touchStartY-touchEndY)?Math.abs(touchStartX-touchEndX)>container.width()/100*options.touchSensitivity&&(touchStartX>touchEndX?scrolling("down",scrollable):touchEndX>touchStartX&&scrolling("up",scrollable)):Math.abs(touchStartY-touchEndY)>container.height()/100*options.touchSensitivity&&(touchStartY>touchEndY?scrolling("down",scrollable):touchEndY>touchStartY&&scrolling("up",scrollable))}}}function checkParentForNormalScrollElement(el,hop){hop=hop||0;var parent=$(el).parent();return!!(hop<options.normalScrollElementTouchThreshold&&parent.is(options.normalScrollElements))||hop!=options.normalScrollElementTouchThreshold&&checkParentForNormalScrollElement(parent,++hop)}function addVerticalNavigation(){$("body").append('<div id="pp-nav"><ul></ul></div>');var nav=$("#pp-nav");nav.css("color",options.navigation.textColor),nav.addClass(options.navigation.position);for(var cont=0;cont<$(".pp-section").length;cont++){var link="";if(options.anchors.length&&(link=options.anchors[cont]),"undefined"!==options.navigation.tooltips){var tooltip=options.navigation.tooltips[cont];void 0===tooltip&&(tooltip="")}nav.find("ul").append('<li data-tooltip="'+tooltip+'"><a href="#'+link+'"><span></span></a></li>')}nav.find("span").css("border-color",options.navigation.bulletsColor)}function activateNavDots(name,sectionIndex){options.navigation&&($("#pp-nav").find(".active").removeClass("active"),name?$("#pp-nav").find('a[href="#'+name+'"]').addClass("active"):$("#pp-nav").find("li").eq(sectionIndex).find("a").addClass("active"))}function activateMenuElement(name){options.menu&&($(options.menu).find(".active").removeClass("active"),$(options.menu).find('[data-menuanchor="'+name+'"]').addClass("active"))}function support3d(){var el=document.createElement("p"),has3d,transforms={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var t in document.body.insertBefore(el,null),transforms)el.style[t]!==undefined&&(el.style[t]="translate3d(1px,1px,1px)",has3d=window.getComputedStyle(el).getPropertyValue(transforms[t]));return document.body.removeChild(el),has3d!==undefined&&has3d.length>0&&"none"!==has3d}function getTranslate3d(){return"vertical"!==options.direction?"translate3d(-100%, 0px, 0px)":"translate3d(0px, -100%, 0px)"}$(document).on("click touchstart","#pp-nav a",function(e){e.preventDefault();var index=$(this).parent().index();scrollPage($(".pp-section").eq(index))}),$(document).on({mouseenter:function(){var tooltip=$(this).data("tooltip");$('<div class="pp-tooltip '+options.navigation.position+'">'+tooltip+"</div>").hide().appendTo($(this)).fadeIn(200)},mouseleave:function(){$(this).find(".pp-tooltip").fadeOut(200,function(){$(this).remove()})}},"#pp-nav li")}}(jQuery,document,window);